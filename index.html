/**
 * @OnlyCurrentDoc
 */

// WARNING: Add your Firebase config here. This is NOT visible to the client.
const FIREBASE_CONFIG = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
};

const APP_ID = FIREBASE_CONFIG.appId;

/**
 * Serves the HTML file to the client.
 * @return {HtmlOutput} The HTML output.
 */
function doGet() {
    return HtmlService.createTemplateFromFile('index').evaluate()
        .setTitle('글쓰기 기록지');
}

/**
 * Gets the Firebase config and authentication token for the client.
 * @return {object} The Firebase config and auth token.
 */
function getFirebaseConfigAndAuthToken() {
    const user = Session.getActiveUser();
    const email = user.getEmail();

    // Use a unique UID for each user
    const uid = Utilities.base64Encode(Utilities.newDigestValue(email, Utilities.DigestAlgorithm.SHA_256).getBytes()).substring(0, 16);
    const customToken = FirebaseApp.getAuthToken(uid);

    return {
        firebaseConfig: FIREBASE_CONFIG,
        initialAuthToken: customToken,
        appId: APP_ID
    };
}

/**
 * The Firebase configuration and authentication token are passed securely to the client.
 * NOTE: The client-side code will use these values to initialize Firebase.
 */
